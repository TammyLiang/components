<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
		<!--<script src="https://res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/vconsole/2.5.1/vconsole.min.js"></script>-->
		<style type="text/css">
			html,body {
				height: 100%;
				background: #fff;
				overflow: hidden;
			}
			.text {
				font-size: 30px;
				text-align: center;
			}
			.load {
				width: 100%;
				height: 137px;
				position: fixed;
				left: 0;
				top: 50%;
				margin-top: -68.5px;

			}
			.load img{
				width: 238px;
				height: 137px;
				position: absolute;
				left: 50%;
				margin-left: -119px;
				top: 50px;
			}
		</style>
	</head>

	<body>
		<div class="load">
			<img src="./loading.gif" alt="" class="load"/>
		</div>
		
		<script src="https://cdn.bootcss.com/jquery/2.0.1/jquery.min.js" type="text/javascript" charset="utf-8"></script>

		<script type="text/javascript">
			$(function() {
				function getUrlParamObj(ename) {
					var url = window.location.href;
					var Request = new Object();
					if (url.indexOf("?") != -1) {
						var str = url.split('?')[1];
						var strs = str.split("&");
						for (var i = 0; i < strs.length; i++) {
							Request[strs[i].split("=")[0]] = (strs[i].split("=")[1]);
						}
					} else {
						return '';
					}
					return Request[ename];
				}

				var token = getUrlParamObj('token');
				//token=fa80c3ba20b704611fc107500e16a7b8
				$.ajax({
					type: "post",
					url: "//uic-api.beeplay123.com/uic/api/okooo/login",
					data: JSON.stringify({
						systemCode: 2,
						token: token
					}),
					contentType: "application/json;charset=UTF-8",
					beforeSend: function(request) {
			            request.setRequestHeader("App-Channel", 100006),
			            request.setRequestHeader("App-Version"," 3.0.0.0")
			        },
					dataType: "json",
					success: function(data) {
						console.log(data)
						localStorage.setItem('APP_VERSION', '3.0.0.0')
						localStorage.setItem('APP_CHANNEL', 100006);
						getToken(data.data);
//						window.location.href = 'https://wap.beeplay123.com/wap/home/1000/?channel=100006';
						
					}
				});
				
				
				
				function getToken(token) {
					$.ajax({
						type: "post",
						url: "//uic-api.beeplay123.com/uic/api/user/login/accessToken",
						data: JSON.stringify({
							type: 1,
							token: token
						}),
						contentType: "application/json;charset=UTF-8",
						beforeSend: function(request) {
				            request.setRequestHeader("App-Channel", 100006),
				            request.setRequestHeader("App-Version"," 3.0.0.0")
				        },
						dataType: "json",
						success: function(res) {
							
							localStorage.setItem('ACCESS_TOKEN', res.data.accessToken)
							localStorage.setItem('APP_VERSION', '3.0.0.0')
							localStorage.setItem('APP_CHANNEL', 100006);
							getJumpURL(res.data.accessToken)
							// window.location.href = 'https://wap.beeplay123.com/wap/home/1000/?channel=100006';
							
						}
					});
				}

				function getJumpURL(token){
					$.ajax({
						 	type: "post",
							url: "//ops-api.beeplay123.com/ops/api/behavior/redirect",
							contentType: "application/json;charset=UTF-8",
							beforeSend: function(request) {
								request.setRequestHeader("App-Channel", 100006),
								request.setRequestHeader("App-Version"," 3.0.0.0"),
				            	request.setRequestHeader("Authorization",token)
								
							},
							dataType: "json",
							success: function(res) {
								if(res.data.redirect == 0){
									window.location.href = 'https://wap.beeplay123.com/wap/home/?channel=100006&token='+token;
								}else{
									window.location.href = 'https://wap.beeplay123.com/channel/newokooo/billiards/?channel=100006&token='+token
								}
								
							}
						});
					}
				

			})
		</script>

	</body>

</html>